{"paragraphs":[{"text":"import org.apache.spark.ml._\nimport org.apache.spark.ml.feature._\nimport org.apache.spark.ml.regression._\nimport org.apache.spark.ml.regression.LinearRegression\nimport org.apache.spark.ml.regression.LinearRegressionModel\nimport org.apache.spark.ml.feature.{OneHotEncoder, StringIndexer}\nimport org.apache.spark.ml.feature.ChiSqSelector\nimport org.apache.spark.mllib.linalg.Vectors\nimport org.apache.spark.mllib.regression.LabeledPoint\nimport org.apache.spark.mllib.regression.LinearRegressionWithSGD\nimport org.apache.spark.ml.recommendation.ALS\nimport org.apache.spark.ml.evaluation.RegressionEvaluator\nimport org.apache.spark.mllib.recommendation.MatrixFactorizationModel\nimport org.apache.spark.mllib.recommendation.Rating\nimport org.apache.spark.mllib.recommendation.ALS\n\n\n","dateUpdated":"Mar 18, 2017 12:10:45 AM","config":{"enabled":true,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"editorMode":"ace/mode/scala","colWidth":12},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1489616161329_2109152427","id":"20170315-221601_963799125","result":{"code":"SUCCESS","type":"TEXT","msg":"import org.apache.spark.ml._\nimport org.apache.spark.ml.feature._\nimport org.apache.spark.ml.regression._\nimport org.apache.spark.ml.regression.LinearRegression\nimport org.apache.spark.ml.regression.LinearRegressionModel\nimport org.apache.spark.ml.feature.{OneHotEncoder, StringIndexer}\nimport org.apache.spark.ml.feature.ChiSqSelector\nimport org.apache.spark.mllib.linalg.Vectors\nimport org.apache.spark.mllib.regression.LabeledPoint\nimport org.apache.spark.mllib.regression.LinearRegressionWithSGD\nimport org.apache.spark.ml.recommendation.ALS\nimport org.apache.spark.ml.evaluation.RegressionEvaluator\nimport org.apache.spark.mllib.recommendation.MatrixFactorizationModel\nimport org.apache.spark.mllib.recommendation.Rating\nimport org.apache.spark.mllib.recommendation.ALS\n"},"dateCreated":"Mar 15, 2017 10:16:01 PM","dateStarted":"Mar 18, 2017 12:10:47 AM","dateFinished":"Mar 18, 2017 12:14:07 AM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:74","focus":true},{"text":"sqlContext.sql(\"Create database recommender\")","dateUpdated":"Mar 15, 2017 10:39:35 PM","config":{"enabled":true,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"editorMode":"ace/mode/scala","colWidth":12},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1489616161339_2106843934","id":"20170315-221601_577072921","dateCreated":"Mar 15, 2017 10:16:01 PM","dateStarted":"Mar 15, 2017 10:39:36 PM","dateFinished":"Mar 15, 2017 10:40:10 PM","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:75"},{"text":"sqlContext.sql(\"use recommender\")","dateUpdated":"Mar 18, 2017 12:14:37 AM","config":{"enabled":true,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"editorMode":"ace/mode/scala","colWidth":12},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1489616161340_2104920189","id":"20170315-221601_828433395","result":{"code":"SUCCESS","type":"TEXT","msg":"res1: org.apache.spark.sql.DataFrame = [result: string]\n"},"dateCreated":"Mar 15, 2017 10:16:01 PM","dateStarted":"Mar 18, 2017 12:14:38 AM","dateFinished":"Mar 18, 2017 12:15:05 AM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:76","focus":true},{"text":"%hive\n\nCREATE EXTERNAL TABLE recommender.ratings (\n    artist INT,\n\ttrack INT,\n\tuserId INT,\n\trating DOUBLE,\n\ttime INT\n  )\nROW FORMAT DELIMITED\n\tFIELDS TERMINATED BY ','\n\tLINES TERMINATED BY '\\n'\nLOCATION '/user/lab/CapstoneProj/ratings'\ntblproperties (\"skip.header.line.count\"=\"1\")","dateUpdated":"Mar 16, 2017 9:40:52 PM","config":{"enabled":true,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[{"name":"Update Count","index":0,"aggr":"sum"}],"values":[],"groups":[],"scatter":{"xAxis":{"name":"Update Count","index":0,"aggr":"sum"}}},"editorMode":"ace/mode/scala","colWidth":12},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1489616161341_2104535440","id":"20170315-221601_863790843","dateCreated":"Mar 15, 2017 10:16:01 PM","dateStarted":"Mar 16, 2017 9:40:53 PM","dateFinished":"Mar 16, 2017 9:41:39 PM","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:77"},{"text":"%hive\nLOAD DATA inpath '/user/lab/CapstoneProj/train_clean.csv' OVERWRITE INTO TABLE recommender.ratings","dateUpdated":"Mar 16, 2017 9:42:51 PM","config":{"enabled":true,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"editorMode":"ace/mode/scala","colWidth":12},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1489616161342_2105689687","id":"20170315-221601_743244581","dateCreated":"Mar 15, 2017 10:16:01 PM","dateStarted":"Mar 16, 2017 9:42:51 PM","dateFinished":"Mar 16, 2017 9:43:01 PM","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:78"},{"text":"%hive \r\n\r\nCREATE EXTERNAL TABLE recommender.wordsRating (\r\n   \tuserid2 STRING,\r\n\tartist2 STRING,\r\n\tavgRating DOUBLE,\r\n\theard_of STRING,\r\n\town_artist STRING,\r\n\tlike_artist STRING,\r\n\tAggressive INT,\r\n    Edgy INT,\r\n    Thoughtful INT,\r\n    Serious INT,\r\n    GoodLyrics INT,\r\n    Unattractive INT,\r\n    Confident INT,\r\n    Youthful INT,\r\n    Boring INT,\r\n    Current2 INT,\r\n    Cheap INT,\r\n    Calm INT,\r\n    Outgoing INT,\r\n    Inspiring INT,\r\n    Beautiful INT,\r\n    Fun INT,\r\n    Authentic INT,\r\n    Credible INT,\r\n    Cool INT,\r\n    Catchy INT,\r\n    Sensitive INT,\r\n    Superficial INT,\r\n    Passionate INT,\r\n    Timeless INT,\r\n    Depressing INT,\r\n    Original INT,\r\n    Talented INT,\r\n    Distinctive INT,\r\n    Approachable INT,\r\n    Trendsetter INT,\r\n    Noisy INT,\r\n    Upbeat INT,\r\n    Energetic INT,\r\n    None_of_these INT,\r\n    Sexy INT,\r\n    Over2 INT,\r\n    Fake INT,\r\n    Cheesy INT,\r\n    Unoriginal INT,\r\n    Dated INT,\r\n    Unapproachable INT,\r\n    Classic INT,\r\n    Playful INT,\r\n    Arrogant INT,\r\n    Warm INT,\r\n\tartistCluster INT\r\n  )\r\nROW FORMAT DELIMITED\r\n\tFIELDS TERMINATED BY ','\r\n\tLINES TERMINATED BY '\\n'\r\nLOCATION '/user/lab/CapstoneProj/wordsRating'","dateUpdated":"Mar 15, 2017 10:50:02 PM","config":{"enabled":true,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"editorMode":"ace/mode/scala","colWidth":12},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1489616161346_2091838727","id":"20170315-221601_206625446","dateCreated":"Mar 15, 2017 10:16:01 PM","dateStarted":"Mar 15, 2017 10:50:03 PM","dateFinished":"Mar 15, 2017 10:50:41 PM","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:79"},{"text":"%hive \nLOAD DATA inpath '/user/lab/CapstoneProj/ArtistDesc_clean.csv' OVERWRITE INTO TABLE recommender.wordsRating","dateUpdated":"Mar 15, 2017 10:51:27 PM","config":{"enabled":true,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"editorMode":"ace/mode/scala","colWidth":12},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1489616161347_2091453978","id":"20170315-221601_272813723","dateCreated":"Mar 15, 2017 10:16:01 PM","dateStarted":"Mar 15, 2017 10:51:28 PM","dateFinished":"Mar 15, 2017 10:51:50 PM","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:80"},{"text":"%hive \r\n\r\nCREATE EXTERNAL TABLE recommender.userData (\r\n\tuserid STRING,\r\n\tartist STRING,\r\n\ttrack STRING,\r\n\trating DOUBLE,\r\n\ttime INT,\r\n\tgender STRING,\r\n\tage INT,\r\n\tworkingStatus STRING,\r\n\tregion STRING,\r\n\tmusic STRING,\r\n\tlist_own STRING,\r\n\tlist_back STRING,\r\n\tQ1 INT,\r\n\tQ2 INT,\r\n\tQ3 INT,\r\n\tQ4 INT,\r\n\tQ5 INT,\r\n\tQ6 INT,\r\n\tQ7 INT,\r\n\tQ8 INT,\r\n\tQ9 INT,\r\n\tQ10 INT,\r\n\tQ11 INT,\r\n\tQ12 INT,\r\n\tQ13 INT,\r\n\tQ14 INT,\r\n\tQ15 INT,\r\n\tQ16 INT,\r\n\tQ17 INT,\r\n\tQ18 INT,\r\n\tQ19 INT,\r\n\tList_Own2 INT,\r\n\tList_Back2 INT,\r\n\tusercluster INT\r\n  )\r\n\r\nROW FORMAT DELIMITED\r\n\tFIELDS TERMINATED BY ','\r\n\tLINES TERMINATED BY '\\n'\r\nLOCATION '/user/lab/CapstoneProj/userData'\r\n","dateUpdated":"Mar 15, 2017 10:52:07 PM","config":{"enabled":true,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"editorMode":"ace/mode/scala","colWidth":12},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1489616161348_2089530233","id":"20170315-221601_302656116","dateCreated":"Mar 15, 2017 10:16:01 PM","dateStarted":"Mar 15, 2017 10:52:08 PM","dateFinished":"Mar 15, 2017 10:52:31 PM","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:81"},{"text":"%hive\nLOAD DATA inpath '/user/lab/CapstoneProj/trainData_clean.csv' OVERWRITE INTO TABLE recommender.userData","dateUpdated":"Mar 15, 2017 11:16:29 PM","config":{"enabled":true,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"editorMode":"ace/mode/scala","colWidth":12},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1489616161349_2089145484","id":"20170315-221601_1500065516","dateCreated":"Mar 15, 2017 10:16:01 PM","dateStarted":"Mar 15, 2017 11:16:30 PM","dateFinished":"Mar 15, 2017 11:16:44 PM","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:82"},{"text":"val u = sqlContext.table(\"userData\")\nval w = sqlContext.table (\"words\")\nval ad = sqlContext.table(\"wordsRating\")\n\nu.show(10)\nw.show(10)\n","dateUpdated":"Mar 18, 2017 12:20:52 AM","config":{"enabled":true,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"editorMode":"ace/mode/scala","colWidth":12},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1489616161350_2090299731","id":"20170315-221601_143111632","dateCreated":"Mar 15, 2017 10:16:01 PM","dateStarted":"Mar 18, 2017 12:20:52 AM","dateFinished":"Mar 18, 2017 12:21:27 AM","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:83","focus":true},{"text":"// Transform Gender into Numeric Index\nval gend_ind = new StringIndexer().\n    setInputCol(\"gender\").\n    setOutputCol(\"genderIndex\").\n    fit(u)\n\nval u2 = gend_ind.transform(u)\n//Save Gender Indexer\ngend_ind.save(\"/user/lab/CapstoneProj/genderIndexer\")\n\n// Transform Music into Numeric Index\nval music_ind = new StringIndexer().\n    setInputCol(\"music\").\n    setOutputCol(\"musicIndex\").\n    fit(u2)\n    \nval u3 = music_ind.transform(u2)\n//Save Music Indexer\nmusic_ind.save(\"/user/lab/CapstoneProj/musicIndexer\")\n\nu3.show(2)","dateUpdated":"Mar 18, 2017 12:28:30 AM","config":{"enabled":true,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"editorMode":"ace/mode/scala","colWidth":12},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1489616161351_2089914982","id":"20170315-221601_95514384","dateCreated":"Mar 15, 2017 10:16:01 PM","dateStarted":"Mar 18, 2017 12:21:46 AM","dateFinished":"Mar 18, 2017 12:22:20 AM","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:84","focus":true},{"text":"// Transform Heard_Of into Numeric Index\nval heard_ind = new StringIndexer().\n    setInputCol(\"heard_of\").\n    setOutputCol(\"heardIndex\").\n    fit(ad)\n    \nval ad2 = heard_ind.transform(ad)\n\n//Save Heard Of Indexer\nheard_ind.save(\"/user/lab/CapstoneProj/heardIndexer\")\nad2.show(2)","dateUpdated":"Mar 18, 2017 12:31:06 AM","config":{"enabled":true,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"editorMode":"ace/mode/scala","colWidth":12},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1489616161352_2087991238","id":"20170315-221601_1139967579","dateCreated":"Mar 15, 2017 10:16:01 PM","dateStarted":"Mar 17, 2017 1:55:45 AM","dateFinished":"Mar 17, 2017 1:55:52 AM","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:85"},{"text":"\n//Create Array of Features variables for Artist Descriptors Table\nval ad_features = Array(\"heardIndex\", \"aggressive\", \"edgy\", \"thoughtful\", \"serious\", \"goodlyrics\", \"unattractive\", \"confident\", \"youthful\", \"boring\", \"current2\", \"cheap\", \"calm\", \"outgoing\", \"inspiring\", \"beautiful\", \"fun\", \"authentic\", \"credible\", \"cool\", \"catchy\", \"sensitive\", \"superficial\", \"passionate\", \"timeless\", \"depressing\", \"original\", \"talented\", \"distinctive\", \"approachable\", \"trendsetter\", \"noisy\", \"upbeat\", \"energetic\", \"none_of_these\", \"sexy\", \"over2\", \"fake\", \"cheesy\", \"unoriginal\", \"dated\", \"unapproachable\", \"classic\", \"playful\", \"arrogant\", \"warm\")\n\n\n//Fill in Null Values\nval ad3 = ad2.na.fill(0)\n\nval ad4 = ad3.withColumn(\"label\", ad3(\"avgRating\"))\n\nval ad_vec = new VectorAssembler().\n    setInputCols(ad_features).\n    setOutputCol(\"features\").\n    transform(ad4)\n    \n","dateUpdated":"Mar 17, 2017 1:56:02 AM","config":{"enabled":true,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"editorMode":"ace/mode/scala","colWidth":12},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1489616161353_2087606489","id":"20170315-221601_1733485366","dateCreated":"Mar 15, 2017 10:16:01 PM","dateStarted":"Mar 17, 2017 1:56:02 AM","dateFinished":"Mar 17, 2017 1:56:08 AM","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:86"},{"text":"//Split Artist Data Into Training and Test Sets\nval Array (ad_train, ad_test) = ad_vec.randomSplit(Array(0.7, 0.3))","dateUpdated":"Mar 17, 2017 1:56:22 AM","config":{"enabled":true,"graph":{"mode":"table","height":132,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"editorMode":"ace/mode/scala","colWidth":11},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1489616161354_2088760735","id":"20170315-221601_1925391160","dateCreated":"Mar 15, 2017 10:16:01 PM","dateStarted":"Mar 17, 2017 1:56:22 AM","dateFinished":"Mar 17, 2017 1:56:25 AM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:87","errorMessage":"","focus":true},{"text":"ad_train.show(5)\nad_test.show(5)","dateUpdated":"Mar 15, 2017 10:16:01 PM","config":{"enabled":true,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"editorMode":"ace/mode/scala","colWidth":12},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1489616161355_2088375986","id":"20170315-221601_1765633124","dateCreated":"Mar 15, 2017 10:16:01 PM","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:88"},{"text":"//Create Regression Model of Artist Data\nval ad_glr = new LinearRegression().\n    setMaxIter(10).\n    setRegParam(0.3).\n    setElasticNetParam(0.8).\n    fit(ad_train)\n    \n\n println(s\"Coefficients: ${ad_glr.coefficients}\")\n println(s\"Intercept: ${ad_glr.intercept}\")\n","dateUpdated":"Mar 17, 2017 1:56:34 AM","config":{"enabled":true,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"editorMode":"ace/mode/scala","colWidth":12},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1489616161356_2086452242","id":"20170315-221601_1066880822","result":{"code":"SUCCESS","type":"TEXT","msg":"ad_glr: org.apache.spark.ml.regression.LinearRegressionModel = linReg_d084167541b6\nCoefficients: [2.5127617542282494,-1.03007926875685,0.879240661683518,0.1505007387382184,0.0,5.707373415942455,-5.974225063717905,1.220429458476497,0.0,-9.210007860783623,0.0,-2.777745318496782,0.46507910620533366,0.0,3.94097581084254,9.26853117913757,3.730047724040275,1.9203612742790923,1.0319514609024527,4.286078403391029,5.790252152065959,0.10094021215126693,-1.3587255564642364,1.608188714473053,4.195728217416878,-5.019250652218326,2.01074350315685,3.7560493121867116,3.1041668283941504,0.860931715967209,0.0,-5.4454235786787395,1.1453268618665338,2.61030463512375,-8.13608456240484,1.6990270971719792,-0.6490805995646911,-1.4039545560735345,-3.33027717535403,-2.773262479703306,-4.032351441581292,-0.5496010483522367,2.0204850834751573,0.0,0.0,1.5018278208678408]\nIntercept: 29.773864236576916\n"},"dateCreated":"Mar 15, 2017 10:16:01 PM","dateStarted":"Mar 17, 2017 1:56:34 AM","dateFinished":"Mar 17, 2017 1:57:26 AM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:89"},{"text":"val trainingSummary = ad_glr.summary\r\nprintln(s\"numIterations: ${trainingSummary.totalIterations}\")\r\nprintln(s\"objectiveHistory: ${trainingSummary.objectiveHistory.toList}\")\r\ntrainingSummary.residuals.show()\r\nprintln(s\"RMSE: ${trainingSummary.rootMeanSquaredError}\")\r\nprintln(s\"MSE: ${trainingSummary.meanSquaredError}\")\r\nprintln(s\"MAE = ${trainingSummary.meanAbsoluteError}\")\r\nprintln(s\"Explained variance = ${trainingSummary.explainedVariance}\")\r\nprintln(s\"r2: ${trainingSummary.r2}\")","dateUpdated":"Mar 17, 2017 1:57:39 AM","config":{"enabled":true,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"editorMode":"ace/mode/scala","colWidth":12},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1489616161356_2086452242","id":"20170315-221601_1725006551","result":{"code":"SUCCESS","type":"TEXT","msg":"trainingSummary: org.apache.spark.ml.regression.LinearRegressionTrainingSummary = org.apache.spark.ml.regression.LinearRegressionTrainingSummary@652aa1a2\nnumIterations: 11\nobjectiveHistory: List(0.4999926354705294, 0.4305120758358424, 0.277179722942046, 0.2726341764191316, 0.26404370468529864, 0.2637976592254436, 0.2637453400558669, 0.2637161051520219, 0.26371248828193505, 0.2637122430095116, 0.2637121563905133)\n+-------------------+\n|          residuals|\n+-------------------+\n| 10.028886995827925|\n|  3.152630055772356|\n| -7.588683912192927|\n| 13.031870717455874|\n|  6.061843525414673|\n|-12.732663219627824|\n|  6.611609509718406|\n|-10.563856375793293|\n| 15.915209018429266|\n|-17.150541428400324|\n|-2.1377796741720765|\n|-11.137779674172076|\n|  8.362220325827924|\n|-10.137779674172076|\n|  9.457604584285512|\n|-14.637779674172076|\n|  16.44960136776122|\n| 24.790267949526474|\n| 16.859421723792828|\n| -7.815869336807367|\n+-------------------+\nonly showing top 20 rows\n\nRMSE: 15.260160826968164\nMSE: 232.87250846493367\nMAE = 12.003749863820113\nExplained variance = 224.32250200459055\nr2: 0.5097637062417327\n"},"dateCreated":"Mar 15, 2017 10:16:01 PM","dateStarted":"Mar 17, 2017 1:57:39 AM","dateFinished":"Mar 17, 2017 1:57:52 AM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:90"},{"text":"//Save Artist Descriptors Regression Model\n\nad_glr.save(\"/user/lab/CapstoneProj/adRegressionModel\")\n\n","dateUpdated":"Mar 17, 2017 1:59:40 AM","config":{"enabled":true,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"editorMode":"ace/mode/scala","colWidth":12},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1489616161358_2087221740","id":"20170315-221601_1155868157","dateCreated":"Mar 15, 2017 10:16:01 PM","dateStarted":"Mar 17, 2017 1:59:40 AM","dateFinished":"Mar 17, 2017 1:59:42 AM","status":"ERROR","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:91"},{"text":"//Load Model\nval sameModel = LinearRegressionModel.load(\"/user/lab/CapstoneProj/adRegressionModel\")\n","dateUpdated":"Mar 17, 2017 1:59:46 AM","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1489715966043_832299934","id":"20170317-015926_1839938172","dateCreated":"Mar 17, 2017 1:59:26 AM","status":"READY","progressUpdateIntervalMs":500,"$$hashKey":"object:92"},{"text":"val test_eval = ad_glr.transform(ad_test)","dateUpdated":"Mar 16, 2017 2:14:40 AM","config":{"enabled":true,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"editorMode":"ace/mode/scala","colWidth":12},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1489616161363_2097609960","id":"20170315-221601_1490706252","dateCreated":"Mar 15, 2017 10:16:01 PM","dateStarted":"Mar 16, 2017 2:14:40 AM","dateFinished":"Mar 16, 2017 2:14:43 AM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:93","errorMessage":"","focus":true},{"text":"test_eval.select($\"userid2\", $\"artist2\", $\"avgrating\",$\"label\", $\"prediction\").show(10)","dateUpdated":"Mar 15, 2017 11:42:29 PM","config":{"enabled":true,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"editorMode":"ace/mode/scala","colWidth":12},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1489616161365_2095301467","id":"20170315-221601_1755751462","result":{"code":"SUCCESS","type":"TEXT","msg":"+-------+-------+-----------+-----------+------------------+\n|userid2|artist2|  avgrating|      label|        prediction|\n+-------+-------+-----------+-----------+------------------+\n|     10|      0|       30.0|       30.0| 37.81256484792422|\n|  10000|     11|       51.0|       51.0| 64.29740553394129|\n|  10002|      9|       19.5|       19.5| 21.50582318719772|\n|  10003|     11|       10.5|       10.5| 21.50582318719772|\n|  10005|      9|       52.0|       52.0| 35.23026110630031|\n|  10006|     11|       67.0|       67.0|42.555470304666954|\n|  10012|      9|30.33333333|30.33333333| 21.50582318719772|\n|  10015|     11|       13.0|       13.0|23.149438496592406|\n|  10018|      9|69.66666667|69.66666667| 46.01311817078745|\n|  10021|     11|       12.0|       12.0|29.843998074363583|\n+-------+-------+-----------+-----------+------------------+\nonly showing top 10 rows\n\n"},"dateCreated":"Mar 15, 2017 10:16:01 PM","dateStarted":"Mar 15, 2017 11:42:29 PM","dateFinished":"Mar 15, 2017 11:42:36 PM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:94"},{"text":"val test_MSE = test_eval.select($\"label\", $\"prediction\").map(v => math.pow((v(0).asInstanceOf[Double] - v(1).asInstanceOf[Double]), 2)).mean()\nval test_RMSE = math.sqrt(test_MSE)\nprintln(\"test Mean Squared Error = \" + test_MSE)\nprintln(\"test Root Mean Squared Error = \" + test_RMSE)\n","dateUpdated":"Mar 15, 2017 11:43:17 PM","config":{"enabled":true,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"editorMode":"ace/mode/scala","colWidth":12},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1489616161366_2096455713","id":"20170315-221601_342028407","result":{"code":"SUCCESS","type":"TEXT","msg":"test_MSE: Double = 232.7826850535193\ntest_RMSE: Double = 15.257217474150366\ntest Mean Squared Error = 232.7826850535193\ntest Root Mean Squared Error = 15.257217474150366\n"},"dateCreated":"Mar 15, 2017 10:16:01 PM","dateStarted":"Mar 15, 2017 11:43:17 PM","dateFinished":"Mar 15, 2017 11:43:42 PM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:95"},{"text":"\n//REGRESSION MODEL ON USER DATA\n//Create Array of Features variables\nval features = Array(\"genderIndex\", \"age\", \"musicIndex\", \"q1\", \"q2\", \"q3\", \"q4\", \"q5\", \"q6\", \"q7\", \"q8\", \"q9\", \"q10\", \"q11\", \"q12\", \"q13\", \"q14\", \"q15\", \"q16\", \"q17\", \"q18\", \"q19\", \"list_own2\", \"list_back2\")\n\n//Fill in Null Values\nval u4 = u3.na.fill(0)\n\nval u5 = u4.withColumn(\"label\", u4(\"rating\"))\n\nval u_vec = new VectorAssembler().\n    setInputCols(features).\n    setOutputCol(\"features\").\n    transform(u5)\n\nu_vec.show(5)","dateUpdated":"Mar 17, 2017 2:00:07 AM","config":{"enabled":true,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"editorMode":"ace/mode/scala","colWidth":12},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1489616161380_2077218268","id":"20170315-221601_1498541837","dateCreated":"Mar 15, 2017 10:16:01 PM","dateStarted":"Mar 17, 2017 2:00:08 AM","dateFinished":"Mar 17, 2017 2:00:19 AM","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:96"},{"text":"//Split Data into Training and Test Data Set\nval Array (u_train, u_test) = u_vec.randomSplit(Array(0.7, 0.3))","dateUpdated":"Mar 17, 2017 2:00:33 AM","config":{"enabled":true,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"editorMode":"ace/mode/scala","colWidth":12},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1489616161381_2076833519","id":"20170315-221601_304442443","dateCreated":"Mar 15, 2017 10:16:01 PM","dateStarted":"Mar 17, 2017 2:00:33 AM","dateFinished":"Mar 17, 2017 2:00:36 AM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:97","errorMessage":"","focus":true},{"text":"//Create Regression Model\nval user_glr = new LinearRegression().\n    setMaxIter(10).\n    setRegParam(0.3).\n    setElasticNetParam(0.8)\n    \n//Fit Model\n val user_model = user_glr.fit(u_train)\n \n println(s\"Coefficients: ${user_model.coefficients}\")\n println(s\"Intercept: ${user_model.intercept}\")\n","dateUpdated":"Mar 17, 2017 2:00:40 AM","config":{"enabled":true,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"editorMode":"ace/mode/scala","colWidth":12},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1489616161383_2077603017","id":"20170315-221601_1222180112","result":{"code":"SUCCESS","type":"TEXT","msg":"user_glr: org.apache.spark.ml.regression.LinearRegression = linReg_f2da9479f349\nuser_model: org.apache.spark.ml.regression.LinearRegressionModel = linReg_f2da9479f349\nCoefficients: [0.0,0.0220897472705384,-0.4518487651017511,0.021162745427585988,0.027938518971445947,0.0,0.013661122222809956,0.0,0.0,0.0010996265456707619,0.007965963333347505,0.0,0.0,0.09513802845951772,0.01560116358614796,0.008503360728720438,0.0059952882044237025,0.0,0.06158340061680238,0.06686927551961454,-0.012342732030439804,-0.0188429807060083,0.183407733668935,0.0]\nIntercept: 20.690398149359567\n"},"dateCreated":"Mar 15, 2017 10:16:01 PM","dateStarted":"Mar 17, 2017 2:00:40 AM","dateFinished":"Mar 17, 2017 2:01:31 AM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:98"},{"text":"val trainingSummary = user_model.summary\n\nprintln(s\"numIterations: ${trainingSummary.totalIterations}\")\nprintln(s\"objectiveHistory: ${trainingSummary.objectiveHistory.toList}\")\ntrainingSummary.residuals.show()\nprintln(s\"RMSE: ${trainingSummary.rootMeanSquaredError}\")\nprintln(s\"MSE: ${trainingSummary.meanSquaredError}\")\nprintln(s\"MAE = ${trainingSummary.meanAbsoluteError}\")\nprintln(s\"Explained variance = ${trainingSummary.explainedVariance}\")\nprintln(s\"r2: ${trainingSummary.r2}\")\n","dateUpdated":"Mar 17, 2017 2:01:47 AM","config":{"enabled":true,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"editorMode":"ace/mode/scala","colWidth":12},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1489616161385_2075294524","id":"20170315-221601_500058829","result":{"code":"SUCCESS","type":"TEXT","msg":"trainingSummary: org.apache.spark.ml.regression.LinearRegressionTrainingSummary = org.apache.spark.ml.regression.LinearRegressionTrainingSummary@4c287b04\nnumIterations: 11\nobjectiveHistory: List(0.49999595085967563, 0.4827390341695432, 0.47618951644355273, 0.474321967012187, 0.4723593794119861, 0.4720772369580062, 0.4719416466583938, 0.47190852519316295, 0.4718901473297875, 0.4718658387374521, 0.47185319585170854)\n+-------------------+\n|          residuals|\n+-------------------+\n|  4.294143778098167|\n|  5.294143778098167|\n|  4.726934806921513|\n| 25.726934806921513|\n| -7.677720077627875|\n| -7.677720077627875|\n|-17.572744624539553|\n| 11.337908935984103|\n|  5.337908935984103|\n| 15.337908935984103|\n| -2.649240022814652|\n|  32.29429813928564|\n|  33.29429813928564|\n|-30.705701860714363|\n| 31.294298139285637|\n|-21.453880476530998|\n|-2.4538804765309976|\n| -16.89999580722855|\n| 3.1000041927714506|\n| -15.89999580722855|\n+-------------------+\nonly showing top 20 rows\n\nRMSE: 21.85542668605503\nMSE: 477.6596756295263\nMAE = 17.8007117799732\nExplained variance = 29.065502270298072\nr2: 0.0662295847641009\n"},"dateCreated":"Mar 15, 2017 10:16:01 PM","dateStarted":"Mar 17, 2017 2:01:47 AM","dateFinished":"Mar 17, 2017 2:01:59 AM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:99"},{"text":"//Evaluate Model on Test Data\r\nval u_eval = user_model.transform(u_test)\r\n\r\nu_eval.select($\"userid\", $\"artist\", $\"label\", $\"prediction\").show(10)\r\nval test_MSE = u_eval.select($\"label\", $\"prediction\").map(v => math.pow((v(0).asInstanceOf[Double] - v(1).asInstanceOf[Double]), 2)).mean()\r\nval test_RMSE = math.sqrt(test_MSE)\r\nprintln(\"test Mean Squared Error = \" + test_MSE)\r\nprintln(\"test Root Mean Squared Error = \" + test_RMSE)","dateUpdated":"Mar 16, 2017 3:49:12 AM","config":{"enabled":true,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"editorMode":"ace/mode/scala","colWidth":12},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1489616161388_2074140277","id":"20170315-221601_1294967053","result":{"code":"SUCCESS","type":"TEXT","msg":"u_eval: org.apache.spark.sql.DataFrame = [userid: string, artist: string, track: string, rating: double, time: int, gender: string, age: int, workingstatus: string, region: string, music: string, list_own: string, list_back: string, q1: int, q2: int, q3: int, q4: int, q5: int, q6: int, q7: int, q8: int, q9: int, q10: int, q11: int, q12: int, q13: int, q14: int, q15: int, q16: int, q17: int, q18: int, q19: int, list_own2: int, list_back2: int, usercluster: int, genderIndex: double, musicIndex: double, label: double, features: vector, prediction: double]\n+------+------+-----+------------------+\n|userid|artist|label|        prediction|\n+------+------+-----+------------------+\n|     0|     0| 31.0|26.601212404791465|\n|     1|     0| 28.0|23.103422889227595|\n|     1|     0| 27.0|23.103422889227595|\n|    10|     0| 30.0| 37.71405523719265|\n|  1000|     0| 42.0| 36.47896030448389|\n| 10000|     9| 47.0| 49.56067376425503|\n| 10000|     9| 49.0| 49.56067376425503|\n| 10001|     9| 74.0| 40.52483130659105|\n| 10002|    11|  7.0| 31.59604646375789|\n| 10003|     9| 30.0|  26.5233216131893|\n+------+------+-----+------------------+\nonly showing top 10 rows\n\ntest_MSE: Double = 479.4425212593077\ntest_RMSE: Double = 21.896175950592554\ntest Mean Squared Error = 479.4425212593077\ntest Root Mean Squared Error = 21.896175950592554\n"},"dateCreated":"Mar 15, 2017 10:16:01 PM","dateStarted":"Mar 16, 2017 3:49:12 AM","dateFinished":"Mar 16, 2017 3:49:35 AM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:100"},{"text":"//REGRESSION MODEL ON JOINED DATA SET\n// Join Artist and User Ratings Tables\nval join_data = u4.join(ad3, u4(\"userid\") === ad3(\"userid2\") && u4(\"artist\") === ad3(\"artist2\"))\n","dateUpdated":"Mar 17, 2017 2:02:14 AM","config":{"enabled":true,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"editorMode":"ace/mode/scala","colWidth":12},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1489616161389_2073755528","id":"20170315-221601_1911981073","dateCreated":"Mar 15, 2017 10:16:01 PM","dateStarted":"Mar 17, 2017 2:02:14 AM","dateFinished":"Mar 17, 2017 2:02:17 AM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:101","errorMessage":"","focus":true},{"text":"//Create Array of Features variables\nval features = Array(\"genderIndex\", \"age\", \"musicIndex\", \"q1\", \"q2\", \"q3\", \"q4\", \"q5\", \"q6\", \"q7\", \"q8\", \"q9\", \"q10\", \"q11\", \"q12\", \"q13\", \"q14\", \"q15\", \"q16\", \"q17\", \"q18\", \"q19\", \"list_own2\", \"list_back2\", \"heardIndex\", \"aggressive\", \"edgy\", \"thoughtful\", \"serious\", \"goodlyrics\", \"unattractive\", \"confident\", \"youthful\", \"boring\", \"current2\", \"cheap\", \"calm\", \"outgoing\", \"inspiring\", \"beautiful\", \"fun\", \"authentic\", \"credible\", \"cool\", \"catchy\", \"sensitive\", \"superficial\", \"passionate\", \"timeless\", \"depressing\", \"original\", \"talented\", \"distinctive\", \"approachable\", \"trendsetter\", \"noisy\", \"upbeat\", \"energetic\", \"none_of_these\", \"sexy\", \"over2\", \"fake\", \"cheesy\", \"unoriginal\", \"dated\", \"unapproachable\", \"classic\", \"playful\", \"arrogant\", \"warm\")\n\n\n//Fill in Null Values\nval join_data2 = join_data.na.fill(0)\n\n//Create Vector of Features\nval join_vec = new VectorAssembler().\n    setInputCols(features).\n    setOutputCol(\"features\").\n    transform(join_data2)","dateUpdated":"Mar 17, 2017 2:02:22 AM","config":{"enabled":true,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"editorMode":"ace/mode/scala","colWidth":12},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1489616161390_2074909775","id":"20170315-221601_1868083850","dateCreated":"Mar 15, 2017 10:16:01 PM","dateStarted":"Mar 17, 2017 2:02:22 AM","dateFinished":"Mar 17, 2017 2:02:30 AM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:102","errorMessage":"","focus":true},{"text":"//CREATE SEPARATE TABLES FOR RATINGS AND AVERAGE RATINGS\r\nval join_rating = join_vec.select($\"userid\", $\"artist\", $\"rating\".alias(\"label\"), $\"features\")\r\n\r\nval join_avg = join_vec.select($\"userid\", $\"artist\", $\"avgrating\".alias(\"label\"), $\"features\")","dateUpdated":"Mar 17, 2017 2:02:39 AM","config":{"enabled":true,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"editorMode":"ace/mode/scala","colWidth":12},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1489616161392_2084913246","id":"20170315-221601_1492437451","result":{"code":"SUCCESS","type":"TEXT","msg":"join_rating: org.apache.spark.sql.DataFrame = [userid: string, artist: string, label: double, features: vector]\njoin_avg: org.apache.spark.sql.DataFrame = [userid: string, artist: string, label: double, features: vector]\n"},"dateCreated":"Mar 15, 2017 10:16:01 PM","dateStarted":"Mar 17, 2017 2:02:39 AM","dateFinished":"Mar 17, 2017 2:02:44 AM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:103"},{"text":"//Model Joined Data On Ratings\r\n//Split Joined Data Set into Training and Test Data\r\nval Array (joinr_train, joinr_test) = join_rating.randomSplit(Array(0.7, 0.3))\r\n\r\n//Create Regression Model for Joined Dataset\r\nval joinr_glr = new LinearRegression().\r\n    setMaxIter(10).\r\n    setRegParam(0.3).\r\n    setElasticNetParam(0.8).\r\n    fit(joinr_train)\r\n \r\n println(s\"Coefficients: ${joinr_glr.coefficients}\")\r\n println(s\"Intercept: ${joinr_glr.intercept}\")\r\n\r\nval trainingSummary = joinr_glr.summary\r\nprintln(s\"numIterations: ${trainingSummary.totalIterations}\")\r\nprintln(s\"objectiveHistory: ${trainingSummary.objectiveHistory.toList}\")\r\ntrainingSummary.residuals.show()\r\nprintln(s\"RMSE: ${trainingSummary.rootMeanSquaredError}\")\r\nprintln(s\"MSE: ${trainingSummary.meanSquaredError}\")\r\nprintln(s\"MAE = ${trainingSummary.meanAbsoluteError}\")\r\nprintln(s\"Explained variance = ${trainingSummary.explainedVariance}\")\r\nprintln(s\"r2: ${trainingSummary.r2}\")\r\n\r\n//Evaluate Model on Test Data\r\nval joinrtest_eval = joinr_glr.transform(joinr_test)\r\n\r\njoinrtest_eval.select($\"userid\", $\"artist\", $\"label\", $\"prediction\").show(10)\r\nval test_MSE = joinrtest_eval.select($\"label\", $\"prediction\").map(v => math.pow((v(0).asInstanceOf[Double] - v(1).asInstanceOf[Double]), 2)).mean()\r\nval test_RMSE = math.sqrt(test_MSE)\r\nprintln(\"test Mean Squared Error = \" + test_MSE)\r\nprintln(\"test Root Mean Squared Error = \" + test_RMSE)\r\n","dateUpdated":"Mar 17, 2017 2:02:50 AM","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1489624653294_371313259","id":"20170316-003733_1720581531","result":{"code":"SUCCESS","type":"TEXT","msg":"joinr_train: org.apache.spark.sql.DataFrame = [userid: string, artist: string, label: double, features: vector]\njoinr_test: org.apache.spark.sql.DataFrame = [userid: string, artist: string, label: double, features: vector]\njoinr_glr: org.apache.spark.ml.regression.LinearRegressionModel = linReg_941d486de4b8\nCoefficients: [0.0,0.0,0.0,0.005896127597178168,0.011722821511965319,0.0,0.012784569045672364,0.011213667107050298,0.0012245968299950405,-0.0,0.01607979960512527,0.0,0.0,0.03343783884881783,0.008019573960029695,0.003158589610296207,0.0,0.004596225916680285,0.029334233059266017,0.013245460751264888,0.0,0.0,0.0756825648204217,0.0,1.1341131907476296,-0.360598447528833,0.17408088418119586,0.20595028200149437,0.0,5.552156316813415,-5.3994684121613306,1.5096027208214675,0.0,-8.199266204740185,0.0,-2.1940554077177663,0.11298084123239471,0.0,3.246948719663294,9.29074230698268,3.321369295895507,1.817603258012427,0.8485517637700027,3.585936175217724,6.239210150591957,-0.0,-1.2453518636528467,1.1738525734816938,5.319346052947114,-5.371346239003797,1.9803122549704897,3.7573843642375393,3.6205813680639154,0.8796201515382266,0.0,-5.225513107053807,1.0348034416150178,2.158455776283041,-7.53272111819673,1.6134552418352335,-0.3517204582881163,-1.1568752204077435,-3.1952993335880633,-2.758064732286563,-3.5337515521016627,-0.5267842292175676,2.024290482345219,0.0,0.0,1.0907748419710024]\nIntercept: 23.740718046095306\ntrainingSummary: org.apache.spark.ml.regression.LinearRegressionTrainingSummary = org.apache.spark.ml.regression.LinearRegressionTrainingSummary@6c0a1c94\nnumIterations: 11\nobjectiveHistory: List(0.4999959109569994, 0.43296350777291126, 0.30272029917537396, 0.2989416460668059, 0.29190011860491083, 0.2915395504933743, 0.29098161680274315, 0.2909361880146375, 0.2908787315140971, 0.2908473914230794, 0.290839546301139)\n+-------------------+\n|          residuals|\n+-------------------+\n|  7.781273265856306|\n|  41.51800572433426|\n|  2.518005724334259|\n|  42.51800572433426|\n| 2.0295536989942775|\n| 3.1078924449897443|\n| 1.1078924449897443|\n|-20.788268338549997|\n|    2.5047115548644|\n|    3.5047115548644|\n|   20.5047115548644|\n| 35.399466736779786|\n| -16.39346214275332|\n| 3.6065378572466784|\n|-11.393462142753322|\n|-11.586495307156376|\n|0.15133973548235602|\n| -6.333444624889097|\n|  42.89392798180644|\n|-20.013298194542415|\n+-------------------+\nonly showing top 20 rows\n\nRMSE: 16.710629204611397\nMSE: 279.2451284140113\nMAE = 13.244935369659505\nExplained variance = 213.40552425851715\nr2: 0.4538742311159145\njoinrtest_eval: org.apache.spark.sql.DataFrame = [userid: string, artist: string, label: double, features: vector, prediction: double]\n+------+------+-----+------------------+\n|userid|artist|label|        prediction|\n+------+------+-----+------------------+\n| 10181|    11| 19.0|22.218726734143694|\n| 10337|    10| 49.0| 45.48199427566574|\n| 10670|    10| 13.0|    53.78826833855|\n| 10670|    10| 74.0|    53.78826833855|\n| 10670|    10| 51.0|    53.78826833855|\n| 10788|    10| 73.0|36.600533263220214|\n| 11043|    15|  7.0| 30.42215313805612|\n| 11205|    15|  9.0| 28.75477008020878|\n| 11818|    15| 18.0|15.867812106164347|\n|  1235|     0| 30.0| 35.56808297776636|\n+------+------+-----+------------------+\nonly showing top 10 rows\n\ntest_MSE: Double = 280.02201396865473\ntest_RMSE: Double = 16.733858310881406\ntest Mean Squared Error = 280.02201396865473\ntest Root Mean Squared Error = 16.733858310881406\n"},"dateCreated":"Mar 16, 2017 12:37:33 AM","dateStarted":"Mar 17, 2017 2:02:50 AM","dateFinished":"Mar 17, 2017 2:10:41 AM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:104"},{"text":"//Model Joined Data On Average Ratings\r\n//Split Joined Data Set into Training and Test Data\r\nval Array (joina_train, joina_test) = join_avg.randomSplit(Array(0.7, 0.3))\r\n\r\n//Create Regression Model for Joined Dataset\r\nval joina_glr = new LinearRegression().\r\n    setMaxIter(10).\r\n    setRegParam(0.3).\r\n    setElasticNetParam(0.8).\r\n    fit(joina_train)\r\n \r\n println(s\"Coefficients: ${joina_glr.coefficients}\")\r\n println(s\"Intercept: ${joina_glr.intercept}\")\r\n\r\nval trainingSummary = joina_glr.summary\r\nprintln(s\"numIterations: ${trainingSummary.totalIterations}\")\r\nprintln(s\"objectiveHistory: ${trainingSummary.objectiveHistory.toList}\")\r\ntrainingSummary.residuals.show()\r\nprintln(s\"RMSE: ${trainingSummary.rootMeanSquaredError}\")\r\nprintln(s\"MSE: ${trainingSummary.meanSquaredError}\")\r\nprintln(s\"MAE = ${trainingSummary.meanAbsoluteError}\")\r\nprintln(s\"Explained variance = ${trainingSummary.explainedVariance}\")\r\nprintln(s\"r2: ${trainingSummary.r2}\")\r\n\r\n\r\nval joinatest_eval = joina_glr.transform(joina_test)\r\njoinatest_eval.select($\"userid\", $\"artist\", $\"label\", $\"prediction\").show(10)\r\nval test_MSE = joinatest_eval.select($\"label\", $\"prediction\").map(v => math.pow((v(0).asInstanceOf[Double] - v(1).asInstanceOf[Double]), 2)).mean()\r\nval test_RMSE = math.sqrt(test_MSE)\r\nprintln(\"test Mean Squared Error = \" + test_MSE)\r\nprintln(\"test Root Mean Squared Error = \" + test_RMSE)\r\n","dateUpdated":"Mar 17, 2017 2:11:33 AM","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1489624755082_-103497532","id":"20170316-003915_584867917","result":{"code":"SUCCESS","type":"TEXT","msg":"joina_train: org.apache.spark.sql.DataFrame = [userid: string, artist: string, label: double, features: vector]\njoina_test: org.apache.spark.sql.DataFrame = [userid: string, artist: string, label: double, features: vector]\njoina_glr: org.apache.spark.ml.regression.LinearRegressionModel = linReg_52080cdd16a9\nCoefficients: [0.0,0.0,0.0,0.006671549521480159,0.009331597379348484,0.0,0.01301036563208435,0.009424490321361209,0.0014211039977016324,2.174803937505366E-5,0.014208980539080302,0.0,0.0,0.03629155281545928,0.00864763440343781,0.004457243963529791,0.0,0.0034192578130501695,0.029625898052032675,0.0148545602020014,-0.0,0.0,0.06059654087005792,0.0,1.1291945071500258,-0.16653351535238542,0.044975543695910405,0.3383992238134792,0.0,5.592833668814417,-5.502155890584077,1.4559724091686328,0.0,-8.201341663897537,0.0,-1.9638380724366078,0.18356727914601623,0.0,3.585747082265858,9.037094692437762,3.4768816226215664,1.8763489292513202,0.8464258113699601,3.5682794094652053,6.255749005471382,0.005433653649503363,-1.244590566773345,1.1409916775026259,5.300515907285983,-5.33551298555701,1.7909630788589863,3.8327025700231987,3.769731336617819,1.0049291279900645,0.0,-5.275417139871917,1.1269324880185585,2.23265736702257,-7.448591157855609,1.5265671464142532,-0.38276292331441075,-0.9114533083721819,-3.089863084410231,-2.7695545580316887,-3.7770062355072795,-0.5580372012498213,1.7811011024441055,0.0,0.0,1.115043428980012]\nIntercept: 23.64364606414351\ntrainingSummary: org.apache.spark.ml.regression.LinearRegressionTrainingSummary = org.apache.spark.ml.regression.LinearRegressionTrainingSummary@2af8636f\nnumIterations: 11\nobjectiveHistory: List(0.49999591185969505, 0.42739105054344195, 0.27313832652986775, 0.2688496519706491, 0.2609109087965006, 0.26040322036735564, 0.2597017987821133, 0.25965625296176764, 0.25957655451050154, 0.25955290795142416, 0.25954707065942695)\n+-------------------+\n|          residuals|\n+-------------------+\n|  2.041418096321454|\n| 23.006520313748858|\n| 23.006520313748858|\n| 23.006520313748858|\n| 1.9167608681535455|\n|-11.687224474010222|\n|-11.687224474010222|\n|  8.787740281220458|\n|  8.787740281220458|\n| -8.000992824817029|\n| -8.000992824817029|\n|-11.903299926846874|\n|-19.724316597985002|\n|0.12445429813634235|\n| -5.931751576542609|\n|  5.815163619203787|\n| -5.705235201796398|\n| 13.179812842118082|\n|-3.8725449417389655|\n|-3.8725449417389655|\n+-------------------+\nonly showing top 20 rows\n\nRMSE: 14.613401689139478\nMSE: 213.55150892814453\nMAE = 11.491453396785442\nExplained variance = 215.21338120059315\nr2: 0.5216866265828447\njoinatest_eval: org.apache.spark.sql.DataFrame = [userid: string, artist: string, label: double, features: vector, prediction: double]\n+------+------+-----------+------------------+\n|userid|artist|      label|        prediction|\n+------+------+-----------+------------------+\n| 10181|    11|       24.5|22.458581903678546|\n| 10337|    10|       68.0| 44.99347968625114|\n| 10505|    11|       45.0| 42.94142400880556|\n| 10505|    11|       45.0| 42.94142400880556|\n| 10670|    10|      42.75| 54.43722447401022|\n| 10670|    10|      42.75| 54.43722447401022|\n|  1073|     0|44.33333333|35.545593048779544|\n| 10788|    10|       72.5|36.798970330941984|\n| 10788|    10|       72.5|36.798970330941984|\n| 10832|    10|17.33333333|25.334326154817028|\n+------+------+-----------+------------------+\nonly showing top 10 rows\n\ntest_MSE: Double = 212.57382481557465\ntest_RMSE: Double = 14.57991168750945\ntest Mean Squared Error = 212.57382481557465\ntest Root Mean Squared Error = 14.57991168750945\n"},"dateCreated":"Mar 16, 2017 12:39:15 AM","dateStarted":"Mar 17, 2017 2:11:33 AM","dateFinished":"Mar 17, 2017 2:18:50 AM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:105"},{"config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1489629756551_1000299969","id":"20170316-020236_1286705490","dateCreated":"Mar 16, 2017 2:02:36 AM","status":"READY","progressUpdateIntervalMs":500,"$$hashKey":"object:106"}],"name":"Capstone Project Recommender System","id":"2CBNV3S4C","angularObjects":{"2CAGX6QBA":[],"2CC13F56N":[],"2CCVRZ6V9":[],"2CDPPBC5E":[],"2CAJHUM8K":[],"2CDW2J81V":[],"2CDURV5T2":[],"2CE497QD9":[],"2CAKUNBDU":[],"2CE9XG62F":[],"2CAYMMTPB":[],"2CAGZM4F7":[],"2CC5MPWK2":[]},"config":{"looknfeel":"default"},"info":{}}